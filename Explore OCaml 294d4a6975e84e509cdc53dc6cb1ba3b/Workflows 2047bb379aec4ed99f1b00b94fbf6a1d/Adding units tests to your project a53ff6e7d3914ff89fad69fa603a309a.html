<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
 <head><title>Adding units tests to your project</title>
  <link rel="stylesheet"
   href="https://fonts.googleapis.com/css2?family=Roboto+Mono&amp;family=Ubuntu:ital,wght@0,400;0,700;1,400&amp;display=swap"
   />
  <link rel="stylesheet" href="../../main.css"/>
  <link rel="stylesheet"
   href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/styles/gruvbox-dark.min.css"
   />
  <script
   src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/highlight.min.js"
   >
  </script>
  <script charset="UTF-8"
   src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/languages/ocaml.min.js"
   >
  </script><script>hljs.initHighlightingOnLoad();</script>
 </head>
 <body>
             
  <div style="display: flex; justify-content: center; align-content: center">
   
           
   <div style="max-width: 800px">
                                           
    <h1>Adding units tests to your project</h1>
<details><summary>Libraries</summary>
    
    <ul><li><a href="../Community%20Libraries%207088de737dff4e97934677e854bc7de8/alcotest%20f73f1d737d8f426aa900b0e7905489fb.html">alcotest</a></li></ul>
  </details><details><summary>Platform</summary>
    
    <ul><li><a href="../Meet%20the%20tools%20c2a8723e00364f7b84870dd39706de39/dune%207063fd3c0d5d4074b7a5c0d97933149c.html">dune</a></li></ul>
  </details><details><summary>Related Workflows</summary>
    
    <ul><li><a href="Checking%20code%20coverage%20bfba2da357fd4cd097f16d8821dffda0.html"> Checking code coverage</a></li><li><a href="Meta%20programming%20with%20PPX%2040be46b47adf449da741758ba4f314c8.html"> Meta programming with PPX</a></li></ul>
  </details><h2>Overview</h2>
<hr />
<p>Testing is critical to ensuring the longevity of your project. When writing code it is very likely some new implementation will break something you wrote before. Testing provides visibility into this.</p>
<p>There are lots of ways you can go about testing and a large part of this is dependent on the type of project you are working on - is it a command line tool, a library, a web-application etc. This workflow focuses mainly on writing unit tests for your OCaml code and so will likely be applicable to most applications.</p>
<h2>Recommended Workflow</h2>
<hr />
<h3>Alcotest</h3>
<p>Alcotest (linked in the libraries) is a unit testing framework. It has a very good example in the repository README.</p>
<p>To add unit testing to your library you'll want to create a test directory with the following <code>dune</code> file.</p>
<pre><code>(* dune file at root *)
(test
  (name test)
  (libraries &lt;library-public-name&gt; alcotest))
</code></pre>
<p>The test entry point will be a <code>[test.ml](http://test.ml)</code> file, which may look something like:</p>
<pre><code class="language-ocaml">(* test.ml in /tests *)
let () = 
  Alcotest.run &quot;&lt;Your-Library&gt;&quot; [
    &quot;Module1&quot;, Test_module1.tests;
    &quot;Module2&quot;, Test_module2.tests
  ]
</code></pre>
<p>Each module can then get its own <code>[test-module.ml](http://test-module.ml)</code> which exports in the  <code>.mli</code> file, a list of Alcotest tests.</p>
<p>The documentation for Alcotest has a more thorough examples and the <strong>real world examples</strong> section at the bottom links some libraries which are already using Alcotest to perform unit testing.</p>
<p>The tests can be run from the command line with <code>dune runtest</code> - it is also common to augment your opam file's build command with running tests:</p>
<pre><code>build: [
 [&quot;dune&quot; &quot;build&quot; &quot;-p&quot; name &quot;-j&quot; jobs]
 [&quot;dune&quot; &quot;runtest&quot; &quot;-p&quot; name] {with-test}
]
</code></pre>
<h2>Alternatives</h2>
<hr />
<h3>QCheck</h3>
<p>QCheck is based on Haskell's <a href="https://hackage.haskell.org/package/QuickCheck">QuickCheck</a> library for property-based testing. It also offers a sub-library that can integrate directly with Alcotest.</p>
<p><a href="https://github.com/c-cube/qcheck">c-cube/qcheck</a></p>
<h3>Dune Expect Tests</h3>
<p>These tests tend to be written inline with your source OCaml code using <code>ppx_inline_test</code>. To get expect tests you can use <code>ppx_expect</code> to write assertions about parts of your program. The documentation covers all of this in much more detail.</p>
<p><a href="https://dune.readthedocs.io/en/stable/tests.html"></a></p>
<h2>Real World Examples</h2>
<hr />
<p><a href="https://github.com/mirage/irmin/tree/master/test">mirage/irmin</a></p>
<p><a href="https://github.com/ocaml-community/yojson/tree/master/test">ocaml-community/yojson</a></p>

    
            
   </div>
               
  </div>
            
          
        </body>
</html>
